INTERMEDIATE PROBLEMS
ðŸ‘‰ You need to combine various concepts covered in the video to solve these

1. Print details of shipments (sales) where amounts are > 2,000 and boxes are <100?
2. How many shipments (sales) each of the sales persons had in the month of January 2022?
3. Which product sells more boxes? Milk Bars or Eclairs?
4. Which product sold more boxes in the first 7 days of February 2022? Milk Bars or Eclairs?
5. Which shipments had under 100 customers & under 100 boxes? Did any of them occur on Wednesday?

HARD PROBLEMS
ðŸ‘‰ These require concepts not covered in the video

1. What are the names of salespersons who had at least one shipment (sale) in the first 7 days of January 2022?
2. Which salespersons did not make any shipments in the first 7 days of January 2022?
3. How many times we shipped more than 1,000 boxes in each month?
4. Did we ship at least one box of â€˜After Ninesâ€™ to â€˜New Zealandâ€™ on all the months?
5. India or Australia? Who buys more chocolate boxes on a monthly basis?




Solutions 



INTERMEDIATE PROBLEMS:

â€” 1. Print details of shipments (sales) where amounts are > 2,000 and boxes are <100?

select * from sales where amount > 2000 and boxes < 100;

â€” 2. How many shipments (sales) each of the sales persons had in the month of January 2022?

select p.Salesperson, count(*) as â€˜Shipment Countâ€™
from sales s
join people p on s.spid = p.spid
where SaleDate between â€˜2022-1-1â€™ and â€˜2022-1-31â€™
group by p.Salesperson;

â€” 3. Which product sells more boxes? Milk Bars or Eclairs?

select pr.product, sum(boxes) as â€˜Total Boxesâ€™
from sales s
join products pr on s.pid = pr.pid
where pr.Product in (â€˜Milk Barsâ€™, â€˜Eclairsâ€™)
group by pr.product;

â€” 4. Which product sold more boxes in the first 7 days of February 2022? Milk Bars or Eclairs?

select pr.product, sum(boxes) as â€˜Total Boxesâ€™
from sales s
join products pr on s.pid = pr.pid
where pr.Product in (â€˜Milk Barsâ€™, â€˜Eclairsâ€™)
and s.saledate between â€˜2022-2-1â€™ and â€˜2022-2-7â€™
group by pr.product;

â€” 5. Which shipments had under 100 customers & under 100 boxes? Did any of them occur on Wednesday?

select * from sales
where customers < 100 and boxes < 100;

select *,
case when weekday(saledate)=2 then â€˜Wednesday Shipmentâ€™
else â€
end as â€˜W Shipmentâ€™
from sales
where customers < 100 and boxes < 100;

 

HARD PROBLEMS:

â€” What are the names of salespersons who had at least one shipment (sale) in the first 7 days of January 2022?

select distinct p.Salesperson
from sales s
join people p on p.spid = s.SPID
where s.SaleDate between â€˜2022-01-01â€™ and â€˜2022-01-07â€™;

â€” Which salespersons did not make any shipments in the first 7 days of January 2022?

select p.salesperson
from people p
where p.spid not in
(select distinct s.spid from sales s where s.SaleDate between â€˜2022-01-01â€™ and â€˜2022-01-07â€™);

â€” How many times we shipped more than 1,000 boxes in each month?

select year(saledate) â€˜Yearâ€™, month(saledate) â€˜Monthâ€™, count(*) â€˜Times we shipped 1k boxesâ€™
from sales
where boxes>1000
group by year(saledate), month(saledate)
order by year(saledate), month(saledate);

â€” Did we ship at least one box of â€˜After Ninesâ€™ to â€˜New Zealandâ€™ on all the months?

set @product_name = â€˜After Ninesâ€™;
set @country_name = â€˜New Zealandâ€™;

select year(saledate) â€˜Yearâ€™, month(saledate) â€˜Monthâ€™,
if(sum(boxes)>1, â€˜Yesâ€™,â€™Noâ€™) â€˜Statusâ€™
from sales s
join products pr on pr.PID = s.PID
join geo g on g.GeoID=s.GeoID
where pr.Product = @product_name and g.Geo = @country_name
group by year(saledate), month(saledate)
order by year(saledate), month(saledate);

â€” India or Australia? Who buys more chocolate boxes on a monthly basis?

select year(saledate) â€˜Yearâ€™, month(saledate) â€˜Monthâ€™,
sum(CASE WHEN g.geo=â€™Indiaâ€™ = 1 THEN boxes ELSE 0 END) â€˜India Boxesâ€™,
sum(CASE WHEN g.geo=â€™Australiaâ€™ = 1 THEN boxes ELSE 0 END) â€˜Australia Boxesâ€™
from sales s
join geo g on g.GeoID=s.GeoID
group by year(saledate), month(saledate)
order by year(saledate), month(saledate);




